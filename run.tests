#!/bin/sh
# run.tests - Check that the algorithm does what it is supposed to

if test -z "$srcdir"; then
  srcdir=.
  test "${VERBOSE+set}" != "set" && VERBOSE=yes
fi

# See how redirections should work.
if test -z "$VERBOSE"; then
   exec > /dev/null 2>&1
fi

path=`dirname $0`

if ! test -f "./fribidi"; then
  echo "run.tests: you must make fribidi first"
  exit 1
fi

TEST () {
  test="$1"
  charset="$2"
  echo "=== Running test $test"
  ./fribidi --test --charset "$charset" \
    "$path/tests/$test" > "$test.output"

  if diff "$test.output" "$path/tests/$test.reference"; then
    rm "$test.output"
    return 0
  else
    return 1
  fi
}

TEST test-CapRTL CapRTL &&
TEST test-hebrew ISO8859-8 &&
TEST test-explicit CapRTL
